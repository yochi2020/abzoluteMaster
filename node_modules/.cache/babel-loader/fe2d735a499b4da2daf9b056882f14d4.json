{"ast":null,"code":"var _jsxFileName = \"/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/user/Userleave.js\";\nimport React, { useEffect, useState, useRef } from 'react';\nimport Footer from '../../component/admin/Footer';\nimport Navbar from '../../component/admin/Navbar';\nimport Sidebar from '../../component/user/Sidebar';\nimport Checkuser from './Checkuser';\nimport Form from './Userleave/Form';\nimport { auth, firestore } from '../../firebase/config';\nimport $ from 'jquery';\nimport { MDBDataTableV5 } from 'mdbreact';\n\nconst Userleave = () => {\n  const [allData, setAllData] = useState([]);\n  const [leaveOfUser, setleaveOfUser] = useState([]);\n  const [appove, setAppove] = useState([]);\n  const [typeLeave, setTypeLeave] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const refAppove = useRef(firestore.collection(\"appove\")).current;\n  const refTypeLeave = firestore.collection(\"type_leave\");\n  const [datatable, setDatatable] = React.useState({\n    columns: [{\n      label: 'วันที่แจ้ง',\n      field: 'leave_date',\n      width: 150,\n      attributes: {\n        'aria-controls': 'DataTable',\n        'aria-label': 'Name'\n      }\n    }, {\n      label: 'วันที่ลา',\n      field: 'leave_start',\n      width: 270\n    }, {\n      label: 'จำนวนวัน',\n      field: 'amount',\n      width: 200\n    }, {\n      label: 'ประเภทการลา',\n      field: 'type_leave_name',\n      sort: 'asc',\n      width: 100\n    }, {\n      label: 'หมายเหตุ',\n      field: 'reson',\n      sort: 'disabled',\n      width: 150\n    }, {\n      label: 'สถานะ',\n      field: 'status',\n      sort: 'disabled',\n      width: 100\n    }, {\n      label: 'จัดการ',\n      field: 'config',\n      sort: 'disabled',\n      width: 100\n    }]\n  });\n  console.log(1);\n  useEffect(() => {\n    console.log(2);\n    const unSubscribeLeaveOfUser = auth.onAuthStateChanged(firebase => {\n      if (!!firebase) {\n        const ref_leave = firestore.collection(\"leave\").where(\"uid\", \"==\", firebase.uid);\n        ref_leave.onSnapshot(doc_leave => {\n          let tempDataArray_leave = [];\n          doc_leave.forEach(data_leave => {\n            tempDataArray_leave = [...tempDataArray_leave, {\n              leave_date: data_leave.data().leave_date,\n              leave_start: data_leave.data().leave_start,\n              reson: data_leave.data().reson,\n              type_leave_id: data_leave.data().type_leave_id,\n              amount: data_leave.data().amount,\n              leave_id: data_leave.id,\n              uid: data_leave.data().uid\n            }];\n          });\n          setleaveOfUser(() => tempDataArray_leave);\n          setLoading(false);\n        });\n      }\n    });\n    const unSubscribeAppove = refAppove.onSnapshot(doc => {\n      let tempArrayAppove = [];\n      doc.forEach(data => {\n        tempArrayAppove = [...tempArrayAppove, {\n          appoveId: data.id,\n          hr_appove: data.data().hr_appove,\n          hr_remark: data.data().hr_remark,\n          leave_appove: data.data().leave_appove,\n          leave_remark: data.data().leave_remark,\n          leave_id: data.data().leave_id,\n          status: data.data().status\n        }];\n      });\n      setAppove(() => tempArrayAppove);\n    });\n    const unSubscribeTypeLeave = refTypeLeave.onSnapshot(doc => {\n      let tempArrayTypeLeave = [];\n      doc.forEach(data => {\n        tempArrayTypeLeave = [...tempArrayTypeLeave, {\n          type_leave_id: data.id,\n          type_leave_name: data.data().type_leave_name\n        }];\n      });\n      setTypeLeave(() => tempArrayTypeLeave);\n    });\n    reload();\n    return () => {\n      unSubscribeLeaveOfUser();\n      unSubscribeAppove();\n      unSubscribeTypeLeave();\n    };\n  }, [loading]);\n  console.log(3);\n\n  const reload = () => {\n    let tempArrayFindData = leaveOfUser;\n    tempArrayFindData.forEach((data, i) => {\n      typeLeave.forEach(dataTypeLeave => {\n        if (dataTypeLeave.type_leave_id === data.type_leave_id) {\n          tempArrayFindData[i] = { ...tempArrayFindData[i],\n            type_leave_name: dataTypeLeave.type_leave_name\n          };\n        }\n      });\n      appove.forEach(dataAppove => {\n        if (dataAppove.leave_id === data.leave_id) {\n          tempArrayFindData[i] = { ...tempArrayFindData[i],\n            status: /*#__PURE__*/React.createElement(\"h1\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 20\n              }\n            }, \"asfaf\")\n          };\n        }\n      });\n    });\n    setDatatable({ ...datatable,\n      rows: tempArrayFindData\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Checkuser, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Sidebar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"m-0 text-dark\",\n    onClick: () => {\n      console.log(datatable);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 23\n    }\n  }, \"\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23\\u0E25\\u0E32\"), /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body table-responsive \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(MDBDataTableV5, {\n    data: datatable,\n    entriesOptions: [5, 20, 25],\n    entries: 5,\n    pagesAmount: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(\"table\", {\n    className: \"table table-hover \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    className: \"thead-dark \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    onClick: () => {\n      console.log(leaveOfUser);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 27\n    }\n  }, \"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\\u0E41\\u0E08\\u0E49\\u0E07\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 27\n    }\n  }, \"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\\u0E25\\u0E32\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 27\n    }\n  }, \"\\u0E08\\u0E33\\u0E19\\u0E27\\u0E19\\u0E27\\u0E31\\u0E19\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 27\n    }\n  }, \"\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\\u0E01\\u0E32\\u0E23\\u0E25\\u0E32\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 27\n    }\n  }, \"\\u0E2B\\u0E21\\u0E32\\u0E22\\u0E40\\u0E2B\\u0E15\\u0E38\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 27\n    }\n  }, \"\\u0E2A\\u0E16\\u0E32\\u0E19\\u0E30\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 27\n    }\n  }, \"\\u0E08\\u0E31\\u0E14\\u0E01\\u0E32\\u0E23\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 23\n    }\n  }, loading ? /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 31\n    }\n  }), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 31\n    }\n  }), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 31\n    }\n  }), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 31\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"spinner-border mx-auto\",\n    style: {\n      width: \"3rem\",\n      height: \"3rem\"\n    },\n    role: \"status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 35\n    }\n  }))) : null))))))))), /*#__PURE__*/React.createElement(\"aside\", {\n    className: \"control-sidebar control-sidebar-dark\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default Userleave;","map":{"version":3,"sources":["/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/user/Userleave.js"],"names":["React","useEffect","useState","useRef","Footer","Navbar","Sidebar","Checkuser","Form","auth","firestore","$","MDBDataTableV5","Userleave","allData","setAllData","leaveOfUser","setleaveOfUser","appove","setAppove","typeLeave","setTypeLeave","loading","setLoading","refAppove","collection","current","refTypeLeave","datatable","setDatatable","columns","label","field","width","attributes","sort","console","log","unSubscribeLeaveOfUser","onAuthStateChanged","firebase","ref_leave","where","uid","onSnapshot","doc_leave","tempDataArray_leave","forEach","data_leave","leave_date","data","leave_start","reson","type_leave_id","amount","leave_id","id","unSubscribeAppove","doc","tempArrayAppove","appoveId","hr_appove","hr_remark","leave_appove","leave_remark","status","unSubscribeTypeLeave","tempArrayTypeLeave","type_leave_name","reload","tempArrayFindData","i","dataTypeLeave","dataAppove","rows","height"],"mappings":"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","sourcesContent":["import React, { useEffect, useState,useRef } from 'react';\nimport Footer from '../../component/admin/Footer';\nimport Navbar from '../../component/admin/Navbar';\nimport Sidebar from '../../component/user/Sidebar';\nimport Checkuser from './Checkuser';\nimport Form from './Userleave/Form';\nimport { auth, firestore } from '../../firebase/config'\nimport $ from 'jquery'\nimport {MDBDataTableV5} from 'mdbreact'\nconst Userleave = () => {\n  const [allData,setAllData]=useState([])\n  const [leaveOfUser, setleaveOfUser] = useState([]) \n  const [appove,setAppove]=useState([])\n  const [typeLeave,setTypeLeave]=useState([])\n  const [loading, setLoading] = useState(true)\n\n\n  const refAppove = useRef(firestore.collection(\"appove\")).current\n  const refTypeLeave = firestore.collection(\"type_leave\")\n\n  const [datatable, setDatatable] = React.useState({\n    columns: [\n      {\n        label: 'วันที่แจ้ง',\n        field: 'leave_date',\n        width: 150,\n        attributes: {\n          'aria-controls': 'DataTable',\n          'aria-label': 'Name',\n        },\n      },\n      {\n        label: 'วันที่ลา',\n        field: 'leave_start',\n        width: 270,\n      },\n      {\n        label: 'จำนวนวัน',\n        field: 'amount',\n        width: 200,\n      },\n      {\n        label: 'ประเภทการลา',\n        field: 'type_leave_name',\n        sort: 'asc',\n        width: 100,\n      },\n      {\n        label: 'หมายเหตุ',\n        field: 'reson',\n        sort: 'disabled',\n        width: 150,\n      },\n      {\n        label: 'สถานะ',\n        field: 'status',\n        sort: 'disabled',\n        width: 100,\n      },\n      {\n        label: 'จัดการ',\n        field: 'config',\n        sort: 'disabled',\n        width: 100,\n      }\n    ],})\nconsole.log(1)\n  useEffect(() => {\n    console.log(2)\n\n    const unSubscribeLeaveOfUser = auth.onAuthStateChanged((firebase) => {\n      if (!!firebase) {\n        const ref_leave = firestore.collection(\"leave\").where(\"uid\", \"==\", firebase.uid)\n        ref_leave.onSnapshot(doc_leave => {\n          let tempDataArray_leave = [];\n          doc_leave.forEach(data_leave => {\n            tempDataArray_leave = [\n              ...tempDataArray_leave,\n              {\n              leave_date:data_leave.data().leave_date,\n              leave_start:data_leave.data().leave_start,\n              reson:data_leave.data().reson,\n              type_leave_id:data_leave.data().type_leave_id,\n              amount:data_leave.data().amount,\n              leave_id:data_leave.id,\n              uid:data_leave.data().uid\n              }\n            ]\n          })\n          setleaveOfUser(()=>tempDataArray_leave)\n          setLoading(false)\n\n        })\n      }\n    })\n\n    const unSubscribeAppove = refAppove.onSnapshot(doc=>{\n      let tempArrayAppove = []\n      doc.forEach(data=>{\n        tempArrayAppove=[\n          ...tempArrayAppove,\n          {\n            appoveId:data.id,\n            hr_appove:data.data().hr_appove,\n            hr_remark:data.data().hr_remark,\n            leave_appove:data.data().leave_appove,\n            leave_remark:data.data().leave_remark,\n            leave_id:data.data().leave_id,\n            status:data.data().status\n          }\n        ]\n      })\n      setAppove(()=>tempArrayAppove)\n    })\n\n    const unSubscribeTypeLeave = refTypeLeave.onSnapshot(doc=>{\n      let tempArrayTypeLeave = []\n      doc.forEach(data=>{\n        tempArrayTypeLeave=[\n          ...tempArrayTypeLeave,\n          {\n            type_leave_id:data.id,\n            type_leave_name:data.data().type_leave_name\n          }\n        ]\n      })\n      setTypeLeave(()=>tempArrayTypeLeave)\n    })\n\n    reload()\n    \n    return () => {\n      unSubscribeLeaveOfUser()\n      unSubscribeAppove()\n      unSubscribeTypeLeave()\n    }\n  },[loading])\n  \n  console.log(3)\n  const reload =()=>{\n    let tempArrayFindData = leaveOfUser\n    tempArrayFindData.forEach((data,i)=>{\n      typeLeave.forEach(dataTypeLeave=>{\n        if(dataTypeLeave.type_leave_id===data.type_leave_id){\n          tempArrayFindData[i]={\n            ...tempArrayFindData[i],\n            type_leave_name:dataTypeLeave.type_leave_name\n          }\n        }\n      })\n\n      appove.forEach(dataAppove=>{\n        if(dataAppove.leave_id===data.leave_id){\n          tempArrayFindData[i]={\n            ...tempArrayFindData[i],\n            status:<h1>asfaf</h1>\n          }\n        }\n      })\n    })\n\n\n    setDatatable({...datatable,rows:tempArrayFindData})\n  }\n  return (\n    <div>\n      <Checkuser />\n      <Navbar />\n      <Sidebar />\n      {/* Content Wrapper. Contains page content */}\n      <div className=\"content-wrapper\">\n        {/* Content Header (Page header) */}\n        <div className=\"content-header\">\n          <div className=\"container-fluid\">\n            <div className=\"row mb-2\">\n            </div>{/* /.row */}\n          </div>{/* /.container-fluid */}\n        </div>\n        {/* /.content-header */}\n        {/* Main content */}\n        <div className=\"content\">\n          <div className=\"container-fluid\">\n            <div className=\"row\">\n              <div className=\"col-lg-12\">\n                <div className=\"card\">\n                  <div className=\"card-header \">\n                    <div className=\"d-flex justify-content-between\">\n                      <h3 className=\"m-0 text-dark\" onClick={()=>{console.log(datatable)}} >รายการลา</h3>\n                      <Form />\n                    </div>\n                  </div>\n                  <div className=\"card-body table-responsive \">\n                  <MDBDataTableV5 data={datatable} entriesOptions={[5, 20, 25]} entries={5} pagesAmount={4}/>\n                    <table className=\"table table-hover \">\n                      <thead className=\"thead-dark \">\n                        <tr>\n                          <th scope=\"col\" onClick={()=>{console.log(leaveOfUser)}}>วันที่แจ้ง</th>\n                          <th scope=\"col\">วันที่ลา</th>\n                          <th scope=\"col\">จำนวนวัน</th>\n                          <th scope=\"col\">ประเภทการลา</th>\n                          <th scope=\"col\">หมายเหตุ</th>\n                          <th scope=\"col\">สถานะ</th>\n                          <th scope=\"col\">จัดการ</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                      \n                      </tbody>\n                      <tbody>\n                      {\n                        loading ?(\n                            <tr>\n                              <td></td>\n                              <td></td>\n                              <td></td>\n                              <td><div className=\"spinner-border mx-auto\" style={{width:\"3rem\",height:\"3rem\"}} role=\"status\">\n                            </div></td>\n                            </tr>\n                         \n                        )\n                        : null\n                      }\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              </div>\n              {/* /.col-md-6 */}\n              {/* /.col-md-6 */}\n            </div>\n            {/* /.row */}\n          </div>\n          {/* /.container-fluid */}\n        </div>\n        {/* /.content */}\n      </div>\n      {/* /.content-wrapper */}\n      {/* Control Sidebar */}\n      <aside className=\"control-sidebar control-sidebar-dark\">\n        {/* Control sidebar content goes here */}\n      </aside>\n      {/* /.control-sidebar */}\n      <Footer />\n    </div >\n  );\n};\n\nexport default Userleave;"]},"metadata":{},"sourceType":"module"}