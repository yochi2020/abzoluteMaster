{"ast":null,"code":"var _jsxFileName = \"/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/admin/Summary.js\";\nimport React, { useState, useEffect } from 'react';\nimport Footer from '../../component/admin/Footer';\nimport Navbar from '../../component/admin/Navbar';\nimport Sidebar from '../../component/admin/Sidebar';\nimport Checkadmin from './Checkadmin';\nimport { firestore } from '../../firebase/config';\nimport { MDBDataTableV5 } from 'mdbreact';\n\nconst Summary = () => {\n  const [user, setUser] = useState([]);\n  const [appove, setAppove] = useState([]);\n  const [leave, setLeave] = useState([]);\n  const [leaveType, setLeaveType] = useState([]);\n  const refLeave = firestore.collection(\"leave\");\n  const refLeaveType = firestore.collection(\"type_leave\");\n  const refUser = firestore.collection(\"user\");\n  const refAppove = firestore.collection(\"appove\");\n  const [loading, setLoading] = useState(true);\n  const [datatable, setDatatable] = useState({\n    columns: [{\n      label: 'ชื่อพนักงาน',\n      field: 'name',\n      width: 200\n    }, {\n      label: 'วันที่แจ้ง',\n      field: 'leave_date',\n      width: 200\n    }, {\n      label: 'วันที่ลา',\n      field: 'leave_start',\n      width: 200\n    }, {\n      label: 'จำนวนวัน',\n      field: 'amount',\n      sort: 'asc',\n      width: 2\n    }, {\n      label: 'ประเภทการลา',\n      field: 'type_leave_name',\n      sort: 'asc',\n      width: 5\n    }, {\n      label: 'เหตุผลที่ลา',\n      field: 'reason',\n      sort: 'asc',\n      width: 5\n    }, {\n      label: 'สถานะ',\n      field: 'status',\n      sort: 'asc',\n      width: 5\n    }]\n  });\n  useEffect(() => {\n    const usersubscribe = refUser.onSnapshot(doc => {\n      let tempArrayUser = [];\n      doc.forEach(data => {\n        tempArrayUser = [...tempArrayUser, {\n          uid: data.id,\n          email: data.data().email,\n          fname: data.data().fname,\n          lname: data.data().lname,\n          name: data.data().name,\n          phone: data.data().phone,\n          user_group: data.data().user_group\n        }];\n      });\n      setUser(tempArrayUser);\n    });\n    const appovescribe = refAppove.onSnapshot(doc => {\n      let tempArrayAppove = [];\n      doc.forEach(data => {\n        tempArrayAppove = [...tempArrayAppove, {\n          leave_id: data.data().leave_id,\n          status: data.data().status\n        }];\n      });\n      setAppove(tempArrayAppove);\n    }); //find all leave\n\n    const leavesubscribe = refLeave.onSnapshot(doc => {\n      let tempArrayLeave = [];\n      doc.forEach(data => {\n        tempArrayLeave = [...tempArrayLeave, {\n          leave_id: data.id,\n          type_leave_id: data.data().type_leave_id,\n          uid: data.data().uid,\n          leave_date: data.data().leave_date,\n          leave_start: data.data().leave_start,\n          reason: data.data().reson,\n          amount: data.data().amount\n        }];\n      });\n      setLeave(tempArrayLeave);\n    });\n    const leaveTypesubscribe = refLeaveType.onSnapshot(doc => {\n      let tempArrayLeaveType = [];\n      doc.forEach(data => {\n        tempArrayLeaveType = [...tempArrayLeaveType, {\n          LeaveTypeId: data.id,\n          type_leave_name: data.data().type_leave_name\n        }];\n      });\n      setLeaveType(tempArrayLeaveType);\n      setLoading(false);\n    });\n    console.log('useEffect');\n    reLoad();\n    window.location.reload();\n    return () => {\n      appovescribe();\n      leavesubscribe();\n      leaveTypesubscribe();\n    };\n  }, [loading]);\n\n  const reLoad = () => {\n    let tempArrayLeave = leave;\n    tempArrayLeave.forEach((dataLeave, i) => {\n      leaveType.forEach(dataLeaveType => {\n        if (dataLeave.type_leave_id === dataLeaveType.LeaveTypeId) {\n          tempArrayLeave[i] = { ...tempArrayLeave[i],\n            type_leave_name: dataLeaveType.type_leave_name\n          };\n        }\n      });\n      user.forEach(dataUser => {\n        if (dataLeave.uid === dataUser.uid) {\n          tempArrayLeave[i] = { ...tempArrayLeave[i],\n            name: dataUser.name\n          };\n        }\n      });\n      appove.forEach(dataAppove => {\n        if (dataLeave.leave_id === dataAppove.leave_id) {\n          let status = '';\n\n          switch (dataAppove.status) {\n            case 'y':\n              status = 'อนุมัติ';\n              break;\n\n            case 'no':\n              status = 'ไม่อนุมัติ';\n              break;\n\n            case '':\n              status = 'รออนุมัติ';\n              break;\n          }\n\n          tempArrayLeave[i] = { ...tempArrayLeave[i],\n            status: /*#__PURE__*/React.createElement(\"span\", {\n              className: \"badge badge-pill badge-dark\",\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 20\n              }\n            }, status)\n          };\n        }\n      });\n    });\n    setDatatable({ ...datatable,\n      rows: tempArrayLeave\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Checkadmin, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Sidebar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-12\",\n    style: {\n      height: '670px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"m-0 text-dark\",\n    onClick: () => console.log(datatable),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 23\n    }\n  }, \"\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23\\u0E25\\u0E32\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body table-responsive \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 19\n    }\n  }, loading ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"spinner-border mx-auto\",\n    style: {\n      width: \"3rem\",\n      height: \"3rem\"\n    },\n    role: \"status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 31\n    }\n  }) : /*#__PURE__*/React.createElement(MDBDataTableV5, {\n    hover: true,\n    entriesOptions: [5, 20, 25],\n    entries: 5,\n    pagesAmount: 4,\n    data: datatable,\n    searchTop: true,\n    searchBottom: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 27\n    }\n  })))))))), /*#__PURE__*/React.createElement(\"aside\", {\n    className: \"control-sidebar control-sidebar-dark\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default Summary;","map":{"version":3,"sources":["/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/admin/Summary.js"],"names":["React","useState","useEffect","Footer","Navbar","Sidebar","Checkadmin","firestore","MDBDataTableV5","Summary","user","setUser","appove","setAppove","leave","setLeave","leaveType","setLeaveType","refLeave","collection","refLeaveType","refUser","refAppove","loading","setLoading","datatable","setDatatable","columns","label","field","width","sort","usersubscribe","onSnapshot","doc","tempArrayUser","forEach","data","uid","id","email","fname","lname","name","phone","user_group","appovescribe","tempArrayAppove","leave_id","status","leavesubscribe","tempArrayLeave","type_leave_id","leave_date","leave_start","reason","reson","amount","leaveTypesubscribe","tempArrayLeaveType","LeaveTypeId","type_leave_name","console","log","reLoad","window","location","reload","dataLeave","i","dataLeaveType","dataUser","dataAppove","rows","height"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\nimport Footer from '../../component/admin/Footer';\nimport Navbar from '../../component/admin/Navbar';\nimport Sidebar from '../../component/admin/Sidebar';\nimport Checkadmin from './Checkadmin';\nimport { firestore} from '../../firebase/config'\nimport {MDBDataTableV5} from 'mdbreact'\nconst Summary = () => {\n  const [user,setUser]=useState([])\n  const [appove,setAppove]=useState([])\n  const [leave,setLeave]=useState([])\n  const [leaveType,setLeaveType]=useState([])\n  const refLeave = firestore.collection(\"leave\")\n  const refLeaveType= firestore.collection(\"type_leave\")\n  const refUser =firestore.collection(\"user\")\n  const refAppove =firestore.collection(\"appove\")\n  const [loading, setLoading] = useState(true)\n  const [datatable, setDatatable] = useState({\n    columns: [\n      {\n        label: 'ชื่อพนักงาน',\n        field: 'name',\n        width: 200,\n      },\n      {\n        label: 'วันที่แจ้ง',\n        field: 'leave_date',\n        width: 200,\n      },\n      {\n        label: 'วันที่ลา',\n        field: 'leave_start',\n        width: 200,\n      },\n      {\n        label: 'จำนวนวัน',\n        field: 'amount',\n        sort: 'asc',\n        width: 2,\n      },\n      {\n        label: 'ประเภทการลา',\n        field: 'type_leave_name',\n        sort: 'asc',\n        width: 5,\n      },\n      {\n        label: 'เหตุผลที่ลา',\n        field: 'reason',\n        sort: 'asc',\n        width: 5,\n      },\n      {\n        label: 'สถานะ',\n        field: 'status',\n        sort: 'asc',\n        width: 5,\n      }\n    ]\n  });\n  useEffect(()=>{\n    const usersubscribe =refUser.onSnapshot(doc=>{\n      let tempArrayUser=[]\n      doc.forEach(data=>{\n        tempArrayUser=[\n          ...tempArrayUser,\n          {\n            uid:data.id,\n            email:data.data().email,\n            fname:data.data().fname,\n            lname:data.data().lname,\n            name:data.data().name,\n            phone:data.data().phone,\n            user_group:data.data().user_group,\n          }\n        ]\n      })\n      setUser(tempArrayUser)\n    })\n    const appovescribe = refAppove.onSnapshot(doc=>{\n      let tempArrayAppove =[]\n      doc.forEach(data=>{\n        tempArrayAppove=[\n          ...tempArrayAppove,\n          {\n            leave_id:data.data().leave_id,\n            status:data.data().status\n          }\n        ]\n      })\n      setAppove(tempArrayAppove)\n    })\n    //find all leave\n    const leavesubscribe =refLeave.onSnapshot(doc=>{\n      let tempArrayLeave=[]\n      doc.forEach(data=>{\n        tempArrayLeave=[\n          ...tempArrayLeave,\n          {\n            leave_id:data.id,\n            type_leave_id:data.data().type_leave_id,\n            uid:data.data().uid,\n            leave_date:data.data().leave_date,\n            leave_start:data.data().leave_start,\n            reason:data.data().reson,\n            amount:data.data().amount\n          }\n        ]\n      })\n      setLeave(tempArrayLeave)\n    })\n    const leaveTypesubscribe =refLeaveType.onSnapshot(doc=>{\n      let tempArrayLeaveType =[]\n      doc.forEach( (data)=>{\n        tempArrayLeaveType=[\n          ...tempArrayLeaveType,\n          {\n            LeaveTypeId:data.id,\n            type_leave_name:data.data().type_leave_name\n          }\n        ]\n      })\n       setLeaveType(tempArrayLeaveType)\n       setLoading(false)\n    })\n    console.log('useEffect')\n    reLoad()\n  window.location.reload()\n\n    return ()=>{\n      appovescribe()\n      leavesubscribe()\n      leaveTypesubscribe()\n      \n    }\n  },[loading])\n  \n\n\nconst reLoad = ()=>{\n  let  tempArrayLeave =leave\n  tempArrayLeave.forEach((dataLeave,i)=>{\n      leaveType.forEach((dataLeaveType)=>{\n        if(dataLeave.type_leave_id===dataLeaveType.LeaveTypeId){\n          tempArrayLeave[i]={\n            ...tempArrayLeave[i],\n            type_leave_name:dataLeaveType.type_leave_name\n          }\n          \n        }\n      })\n      user.forEach(dataUser=>{\n        if(dataLeave.uid===dataUser.uid){\n          tempArrayLeave[i]={\n            ...tempArrayLeave[i],\n            name:dataUser.name\n          }\n        }\n      })\n      appove.forEach(dataAppove=>{\n        if(dataLeave.leave_id===dataAppove.leave_id){\n          let status =''\n          switch (dataAppove.status) {\n            case 'y':status = 'อนุมัติ'\n              break;\n              case 'no':status = 'ไม่อนุมัติ'\n                break;\n                case '':status = 'รออนุมัติ'\n              break;\n          }\n          tempArrayLeave[i]={\n            ...tempArrayLeave[i],\n            status:<span className=\"badge badge-pill badge-dark\">{status}</span>\n          }\n        }\n      })\n    })\n    setDatatable({...datatable,rows:tempArrayLeave})\n}\n  return (\n    <div>\n      <Checkadmin />\n      <Navbar />\n      <Sidebar />\n      {/* Content Wrapper. Contains page content */}\n      <div className=\"content-wrapper\">\n        {/* Content Header (Page header) */}\n        <div className=\"content-header\">\n          <div className=\"container-fluid\">\n            <div className=\"row mb-2\">\n            </div>{/* /.row */}\n          </div>{/* /.container-fluid */}\n        </div>\n        {/* /.content-header */}\n        {/* Main content */}\n        <div className=\"content\">\n          <div className=\"container-fluid\">\n            <div className=\"row\">\n              <div className=\"col-lg-12\" style={{height:'670px'}}>\n                <div className=\"card\">\n                  <div className=\"card-header \">\n                    <div className=\"d-flex justify-content-between\">\n                      <h3 className=\"m-0 text-dark\" onClick={()=>console.log(datatable)} >รายการลาทั้งหมด</h3>\n                    </div>\n                  </div>\n                  <div className=\"card-body table-responsive \" >\n                  {\n                        loading ?(\n                              <div className=\"spinner-border mx-auto\" style={{width:\"3rem\",height:\"3rem\"}} role=\"status\">\n                              </div>\n                        )\n                        : <MDBDataTableV5 hover entriesOptions={[5, 20, 25]}  entries={5} pagesAmount={4} data={datatable} searchTop searchBottom={false}></MDBDataTableV5>\n                      }\n                  </div>\n                </div>\n              </div>\n              {/* /.col-md-6 */}\n              {/* /.col-md-6 */}\n            </div>\n            {/* /.row */}\n          </div>\n          {/* /.container-fluid */}\n        </div>\n        {/* /.content */}\n      </div>\n      \n      {/* /.content-wrapper */}\n      {/* Control Sidebar */}\n      <aside className=\"control-sidebar control-sidebar-dark\">\n        {/* Control sidebar content goes here */}\n      </aside>\n      {/* /.control-sidebar */}\n      <Footer />\n    </div >\n  );\n};\n\nexport default Summary;"]},"metadata":{},"sourceType":"module"}