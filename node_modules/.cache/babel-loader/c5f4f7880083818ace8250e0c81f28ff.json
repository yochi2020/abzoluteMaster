{"ast":null,"code":"var _jsxFileName = \"/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/admin/Employee/Form.js\";\nimport React, { useState, useEffect } from 'react';\nimport { firestore, auth } from '../../../firebase/config';\nimport axios from 'axios';\n\nconst Form = () => {\n  const [data, setData] = useState({\n    email: \"\",\n    password: \"\",\n    name: \"\",\n    fname: \"\",\n    lname: \"\",\n    phone: \"\",\n    user_group: \"employee\"\n  });\n  const [userleave, setUserleave] = useState([]);\n  const [leavetype, setLeavetype] = useState([]);\n  const ref = firestore.collection(\"type_leave\");\n  var allUserleave = [];\n  useEffect(() => {\n    ref.onSnapshot(snapshot => {\n      let tempDataArray = [];\n      let tempLeaveArray = [];\n      snapshot.forEach(data => {\n        tempDataArray = [...tempDataArray, {\n          uid: data.id,\n          leavetype: data.data().type_leave_name\n        }];\n        tempLeaveArray = [...tempLeaveArray, {\n          uid: data.id,\n          leavetype: data.data().type_leave_name,\n          value: 0\n        }];\n      });\n      setLeavetype(tempDataArray);\n      setUserleave(tempLeaveArray);\n    });\n  }, []);\n\n  const clearForm = () => {\n    setData({\n      email: \"\",\n      password: \"\",\n      name: \"\",\n      fname: \"\",\n      lname: \"\",\n      phone: \"\"\n    });\n  };\n\n  const onSignup = e => {\n    clearForm();\n    e.preventDefault();\n    console.log(data);\n    axios.post(\"http://localhost:4000/register\", data).then(async result => {\n      if (!!result) {\n        const userRef = firestore.collection(\"user\").doc(result.data.uid);\n        const doc = await userRef.get();\n\n        if (!doc.data()) {\n          userRef.set({\n            uid: result.data.uid,\n            email: result.data.email,\n            name: data.name,\n            fname: data.fname,\n            lname: data.lname,\n            phone: data.phone,\n            user_group: data.user_group\n          });\n          const quota = firestore.collection(\"quota\"); // const docQuota = await quota.get()\n\n          allUserleave.forEach(item => {\n            //เพิ่มจำนวนการลาของแต่ละคน\n            return quota.add({\n              uid: result.data.uid,\n              type_leave_id: item.uid,\n              amount: item.value\n            });\n          });\n        }\n\n        console.log(result);\n      }\n    }).catch(err => console.log(err)); // auth.createUserWithEmailAndPassword(data.email,data.password)\n    // .then(async (result)=>{\n    //     if(!!result){\n    //         const userRef =firestore.collection(\"user\").doc(result.user.uid)\n    //         const doc = await userRef.get();\n    //         if(!doc.data()){\n    //             await userRef.set({\n    //                 uid:result.user.uid,\n    //                 email:result.user.email,\n    //                 name:data.name,\n    //                 fname:data.fname,\n    //                 lname:data.lname,\n    //                 phone:data.phone,\n    //                 user_group:data.user_group\n    //             })\n    //         }\n    //     }\n    // allUserleave.map(item=>{  //เพิ่มจำนวนการลาของแต่ละคน\n    //   return quota.add({user_id:result.user.uid,type_leave_id:item.uid,amount:item.value}).then(()=>{\n    //     console.log(\"success\")\n    //   }).catch(err=>console.log(err))\n    // })\n    // clearForm();\n    // })\n    // .catch(err=>{\n    //     alert(err.code)\n    // })\n  };\n\n  const leaveChange = e => {\n    const indexForEdit = userleave.findIndex(item => {\n      return item.uid === e.target.name;\n    });\n    allUserleave[indexForEdit] = {\n      uid: e.target.name,\n      value: e.target.value\n    };\n  };\n\n  allUserleave = [...userleave];\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-sm btn-info\",\n    \"data-toggle\": \"modal\",\n    \"data-target\": \"#staticBackdrop\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 5\n    }\n  }, \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E1E\\u0E19\\u0E31\\u0E01\\u0E07\\u0E32\\u0E19\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal fade\",\n    id: \"staticBackdrop\",\n    \"data-backdrop\": \"static\",\n    \"data-keyboard\": \"false\",\n    tabIndex: -1,\n    \"aria-labelledby\": \"staticBackdropLabel\",\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-dialog modal-xl\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"modal-title\",\n    id: \"staticBackdropLabel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 15\n    }\n  }, \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E1E\\u0E19\\u0E31\\u0E01\\u0E07\\u0E32\\u0E19\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"close\",\n    \"data-dismiss\": \"modal\",\n    \"aria-label\": \"Close\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    \"aria-hidden\": \"true\",\n    onClick: () => clearForm(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }\n  }, \"\\xD7\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    onClick: () => console.log(allUserleave),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 23\n    }\n  }, \"\\u0E2D\\u0E35\\u0E40\\u0E21\\u0E25\\u0E4C\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    value: data.email,\n    onChange: e => {\n      setData({ ...data,\n        email: e.target.value\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 23\n    }\n  }, \"Password\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    className: \"form-control\",\n    value: data.password,\n    onChange: e => {\n      setData({ ...data,\n        password: e.target.value\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 23\n    }\n  }, \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E25\\u0E48\\u0E19\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    value: data.name,\n    onChange: e => {\n      setData({ ...data,\n        name: e.target.value\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 23\n    }\n  }, \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E08\\u0E23\\u0E34\\u0E07\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    value: data.fname,\n    onChange: e => setData({ ...data,\n      fname: e.target.value\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 23\n    }\n  }, \"\\u0E19\\u0E32\\u0E21\\u0E2A\\u0E01\\u0E38\\u0E25\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    value: data.lname,\n    onChange: e => {\n      setData({ ...data,\n        lname: e.target.value\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 23\n    }\n  }, \"\\u0E40\\u0E1A\\u0E2D\\u0E23\\u0E4C\\u0E42\\u0E17\\u0E23\\u0E28\\u0E31\\u0E1E\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    value: data.phone,\n    onChange: e => {\n      setData({ ...data,\n        phone: e.target.value\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 19\n    }\n  }, leavetype.map((item, index) => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"inputState\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 27\n    }\n  }, item.leavetype), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control\",\n    type: \"number\",\n    defaultValue: \"0\",\n    min: \"0\",\n    id: \"example-number-input\",\n    name: item.uid,\n    onChange: e => {\n      leaveChange(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 27\n    }\n  }))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary\",\n    \"data-dismiss\": \"modal\",\n    onClick: () => clearForm(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 15\n    }\n  }, \"\\u0E1B\\u0E34\\u0E14\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E08\\u0E2D\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary\",\n    \"data-dismiss\": \"modal\",\n    onClick: e => {\n      onSignup(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 15\n    }\n  }, \"\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"))))));\n};\n\nexport default Form;","map":{"version":3,"sources":["/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/admin/Employee/Form.js"],"names":["React","useState","useEffect","firestore","auth","axios","Form","data","setData","email","password","name","fname","lname","phone","user_group","userleave","setUserleave","leavetype","setLeavetype","ref","collection","allUserleave","onSnapshot","snapshot","tempDataArray","tempLeaveArray","forEach","uid","id","type_leave_name","value","clearForm","onSignup","e","preventDefault","console","log","post","then","result","userRef","doc","get","set","quota","item","add","type_leave_id","amount","catch","err","leaveChange","indexForEdit","findIndex","target","map","index"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\nimport {firestore,auth} from '../../../firebase/config'\nimport axios from 'axios'\nconst Form = () => {\n    const [data,setData]=useState({\n        email:\"\",\n        password:\"\",\n        name:\"\",\n        fname:\"\",\n        lname:\"\",\n        phone:\"\",\n        user_group:\"employee\"\n    })\n    const [userleave,setUserleave]=useState([]);\n    const [leavetype,setLeavetype] = useState([]);\n    const ref = firestore.collection(\"type_leave\");\n\n    var allUserleave = [];\n    useEffect(()=>{\n      ref.onSnapshot(snapshot=>{\n        let tempDataArray=[];\n        let tempLeaveArray=[];\n        snapshot.forEach(data=>{\n          tempDataArray=[\n            ...tempDataArray,\n            {\n              uid:data.id,\n              leavetype:data.data().type_leave_name\n            }\n          ]\n\n          tempLeaveArray=[\n            ...tempLeaveArray,\n            {\n              uid:data.id,\n              leavetype:data.data().type_leave_name,\n              value:0\n            }\n          ]\n        })\n        setLeavetype(tempDataArray)\n        setUserleave(tempLeaveArray)\n      })\n    },[])\n    const clearForm=()=>{\n        setData({\n        email:\"\",\n        password:\"\",\n        name:\"\",\n        fname:\"\",\n        lname:\"\",\n        phone:\"\"\n        })\n    }\n    const onSignup=(e)=>{\n      clearForm()\n        e.preventDefault()    \n        console.log(data)   \n        axios.post(\"http://localhost:4000/register\",data)\n        .then(async (result)=>{\n          \n          if(!!result){\n            const userRef =firestore.collection(\"user\").doc(result.data.uid)\n                    const doc = await userRef.get();\n                    if(!doc.data()){\n                         userRef.set({\n                            uid:result.data.uid,\n                            email:result.data.email,\n                            name:data.name,\n                            fname:data.fname,\n                            lname:data.lname,\n                            phone:data.phone,\n                            user_group:data.user_group\n                        })\n                        const quota = firestore.collection(\"quota\")\n\n                        // const docQuota = await quota.get()\n                         allUserleave.forEach( (item)=>{  //เพิ่มจำนวนการลาของแต่ละคน\n                          return   quota.add({\n                            uid:result.data.uid,\n                            type_leave_id:item.uid,\n                            amount:item.value\n                          })\n                          \n                          })\n                      \n          }\n          console.log(result)\n        }\n        }).catch(err=>console.log(err))\n        // auth.createUserWithEmailAndPassword(data.email,data.password)\n        // .then(async (result)=>{\n        //     if(!!result){\n        //         const userRef =firestore.collection(\"user\").doc(result.user.uid)\n        //         const doc = await userRef.get();\n        //         if(!doc.data()){\n        //             await userRef.set({\n        //                 uid:result.user.uid,\n        //                 email:result.user.email,\n        //                 name:data.name,\n        //                 fname:data.fname,\n        //                 lname:data.lname,\n        //                 phone:data.phone,\n        //                 user_group:data.user_group\n        //             })\n\n        //         }\n        //     }\n            \n            // allUserleave.map(item=>{  //เพิ่มจำนวนการลาของแต่ละคน\n            //   return quota.add({user_id:result.user.uid,type_leave_id:item.uid,amount:item.value}).then(()=>{\n            //     console.log(\"success\")\n            //   }).catch(err=>console.log(err))\n            // })\n            \n            // clearForm();\n        // })\n        // .catch(err=>{\n        //     alert(err.code)\n        // })\n        \n    }\n    const leaveChange=(e)=>{\n      const indexForEdit = userleave.findIndex(item=>{\n        return item.uid=== e.target.name\n      })\n      allUserleave[indexForEdit]={\n              uid:e.target.name,\n              value:e.target.value\n      }\n\n\n\n\n    }\n allUserleave=[...userleave] \n    return (\n        <div>\n    <button className=\"btn btn-sm btn-info\" data-toggle=\"modal\" data-target=\"#staticBackdrop\">เพิ่มพนักงาน</button>\n            {/* <!-- Modal --> */}\n      <div className=\"modal fade\" id=\"staticBackdrop\" data-backdrop=\"static\" data-keyboard=\"false\" tabIndex={-1} aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\n        <div className=\"modal-dialog modal-xl\">\n          <div className=\"modal-content\">\n            <div className=\"modal-header\">\n              <h5 className=\"modal-title\" id=\"staticBackdropLabel\">เพิ่มพนักงาน</h5>\n              <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                <span aria-hidden=\"true\" onClick={()=>clearForm()}>×</span>\n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <div className=\"container-fluid\">\n                <div className=\"row\">\n                  <div className=\"col-md-4\">\n                    <div className=\"form-group\">\n                      <label onClick={()=>console.log(allUserleave)}>อีเมล์</label>\n                      <input type=\"text\" className=\"form-control\" value={data.email} onChange={(e)=>{setData({...data,email:e.target.value})}}></input>\n                    </div>\n                    <div className=\"form-group\">\n                      <label>Password</label>\n                      <input type=\"password\" className=\"form-control\" value={data.password} onChange={(e)=>{setData({...data,password:e.target.value})}}></input>\n                    </div>\n                    <div className=\"form-group\">\n                      <label>ชื่อเล่น</label>\n                      <input type=\"text\" className=\"form-control\" value={data.name} onChange={(e)=>{setData({...data,name:e.target.value})}}></input>\n                    </div>\n                  </div>\n                  <div className=\"col-md-4\">\n                    <div className=\"form-group\">\n                      <label>ชื่อจริง</label>\n                      <input type=\"text\" className=\"form-control\" value={data.fname} onChange={e=>setData({...data,fname:e.target.value})} ></input>\n                    </div>\n                    <div className=\"form-group\">\n                      <label>นามสกุล</label>\n                      <input type=\"text\" className=\"form-control\" value={data.lname} onChange={e=>{setData({...data,lname:e.target.value})}}></input>\n                    </div>\n                    <div className=\"form-group\">\n                      <label>เบอร์โทรศัพ</label>\n                      <input type=\"text\" className=\"form-control\" value={data.phone} onChange={e=>{setData({...data,phone:e.target.value})}}></input>\n                    </div>\n                  </div>\n                  <div className=\"col-md-2\">\n                    {\n                      leavetype.map((item,index)=>(\n                        <div className=\"form-group\" key={index}>\n                          <label htmlFor=\"inputState\">{item.leavetype}</label>\n                          <input className=\"form-control\" type=\"number\" defaultValue=\"0\" min=\"0\" id=\"example-number-input\" name={item.uid} onChange={(e)=>{leaveChange(e)}} />\n                        </div>\n                      ))\n                    }\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"modal-footer\">\n              <button type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\" onClick={()=>clearForm()}>ปิดหน้าจอ</button>\n              <button type=\"button\" className=\"btn btn-primary\" data-dismiss=\"modal\" onClick={(e)=>{onSignup(e)}}>บันทึก</button>\n            </div>\n          </div>\n        </div>\n      </div>\n        </div>\n    );\n}\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}