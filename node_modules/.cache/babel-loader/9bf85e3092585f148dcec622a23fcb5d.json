{"ast":null,"code":"var _jsxFileName = \"/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/admin/Employee.js\";\nimport React, { useEffect, useState } from 'react';\nimport Footer from '../../component/admin/Footer';\nimport Navbar from '../../component/admin/Navbar';\nimport Sidebar from '../../component/admin/Sidebar';\nimport Checkadmin from './Checkadmin';\nimport Form from './Employee/Form';\nimport Userlist from './Employee/Employee';\nimport { firestore } from '../../firebase/config';\nimport axios from 'axios';\nimport { MDBDataTableV5 } from 'mdbreact';\nimport { data } from 'jquery';\n\nfunction Employee() {\n  const [user, setUser] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [editQuota, setEditQuota] = useState([]);\n  const [editUser, setEditUser] = useState([]);\n  const [quota, setQuota] = useState([]); //store all quota\n\n  const [quotaUser, setQuotaUser] = useState([]);\n  const [typeLeave, setTypeLeave] = useState([]); // store all type_leave \n\n  const refUser = firestore.collection(\"user\");\n  const refTypeLeave = firestore.collection(\"type_leave\");\n  const refQuota = firestore.collection(\"quota\");\n  const [datatable, setDatatable] = useState({\n    columns: [{\n      label: 'ชื่อพนักงาน',\n      field: 'name',\n      width: 200,\n      attributes: {\n        'aria-controls': 'DataTable',\n        'aria-label': 'Name'\n      }\n    }, {\n      label: 'อีเมล',\n      field: 'email',\n      width: 200\n    }, {\n      label: 'เบอร์โทร',\n      field: 'phone',\n      width: 200\n    }, {\n      label: 'แก้ไข',\n      field: 'edit',\n      sort: 'asc',\n      width: 5\n    }, {\n      label: 'ลบ',\n      field: 'delete',\n      sort: 'asc',\n      width: 5\n    }]\n  });\n  useEffect(() => {\n    //pull data Quota\n    refQuota.onSnapshot(snapshot => {\n      let tempArrayQuota = [];\n      snapshot.forEach(data => {\n        tempArrayQuota = [...tempArrayQuota, {\n          quota_id: data.id,\n          type_leave_id: data.data().type_leave_id,\n          uid: data.data().uid,\n          amount: data.data().amount\n        }];\n      });\n      setQuota(tempArrayQuota);\n    }); // pull data type_leave\n\n    refTypeLeave.onSnapshot(snapshot => {\n      let tempArrayTypeLeave = [];\n      snapshot.forEach(dataa => {\n        tempArrayTypeLeave = [...tempArrayTypeLeave, {\n          type_leave_id: dataa.id,\n          type_leave_name: dataa.data().type_leave_name\n        }];\n      });\n      setTypeLeave(tempArrayTypeLeave);\n    }); //pull data user\n\n    refUser.onSnapshot(snapshot => {\n      let tempDataArray = [];\n      snapshot.forEach(doc => {\n        tempDataArray = [...tempDataArray, {\n          name: doc.data().fname + doc.data().lname + \" \" + \"(\" + doc.data().name + \")\",\n          email: doc.data().email,\n          phone: doc.data().phone,\n          uid: doc.id,\n          user_group: doc.data().user_group,\n          edit: /*#__PURE__*/React.createElement(\"button\", {\n            className: \"btn btn-sm btn-outline-success \",\n            \"data-toggle\": \"modal\",\n            \"data-target\": \"#staticBackdrop2\",\n            onClick: () => {\n              editHandle(doc.data());\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 18\n            }\n          }, \"\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\"),\n          delete: /*#__PURE__*/React.createElement(\"button\", {\n            className: \"btn btn-sm btn-outline-danger\",\n            onClick: () => {\n              deleteHandle(doc.id);\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 20\n            }\n          }, \"\\u0E25\\u0E1A\")\n        }];\n      });\n      setUser(() => tempDataArray);\n      setLoading(false);\n    });\n    setDatatable({ ...datatable,\n      rows: user\n    });\n    let tempArrayFilterQuotaUser = quota.filter(data => {\n      return data.uid == editUser.uid;\n    });\n    setQuotaUser(() => tempArrayFilterQuotaUser);\n    return () => {};\n  }, [user]);\n\n  const deleteHandle = async uid => {\n    let obj = {\n      uid\n    };\n    var leaveId = ''; //delete leave of uerr\n\n    await firestore.collection('leave').where('uid', '==', obj.uid).onSnapshot(doc => {\n      doc.forEach(data => {\n        firestore.collection(\"leave\").doc(data.id).delete();\n        leaveId = data.id;\n        firestore.collection(\"appove\").where('leave_id', '==', data.id).onSnapshot(doc => {\n          doc.forEach(d => {\n            firestore.collection(\"appove\").doc(d.id).delete();\n          });\n        });\n      });\n      console.log(leaveId);\n    }); // delete quota of user\n\n    await firestore.collection(\"quota\").where('uid', '==', obj.uid).onSnapshot(doc => {\n      doc.forEach(data => {\n        console.log(data.data());\n        firestore.collection(\"quota\").doc(data.id).delete();\n      });\n    }); // delete user\n\n    await axios.post(\"http://localhost:4000/deleteuser\", obj).then(uid => {\n      const refUser = firestore.collection(\"user\").doc(uid.data);\n      refUser.delete();\n    });\n  };\n\n  const editHandle = data => {\n    clearHandle();\n    firestore.collection(\"quota\").where('uid', '==', data.uid).onSnapshot(doc => {\n      let tempArrayquota = [];\n      doc.forEach(data => {\n        tempArrayquota = [...tempArrayquota, {\n          amount: data.data().amount,\n          type_leave_id: data.data().type_leave_id,\n          uid: data.data().uid\n        }];\n      });\n      setEditQuota(tempArrayquota);\n      setEditUser(data);\n    });\n  };\n\n  const submitHandle = () => {\n    console.log(editUser);\n    console.log(editQuota);\n  }; //clear form edit\n\n\n  const clearHandle = () => {\n    setEditUser([]);\n  };\n\n  const countAmount = e => {\n    // console.log(e.target.value)\n    // console.log(e.target.name)\n    // console.log(quotaUser)\n    let quotaOfUser = quotaUser; //find index array of quota user\n\n    let findIndexQuotaUser = quotaUser.findIndex(data => {\n      return data.quota_id === e.target.name;\n    });\n    quotaOfUser[quotaOfUser] = {\n      amount: e.target.value\n    };\n    console.log(quotaOfUser);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Checkadmin, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Sidebar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"m-0 text-dark\",\n    onClick: () => {\n      console.log(quotaUser);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 23\n    }\n  }, \"\\u0E1E\\u0E19\\u0E31\\u0E01\\u0E07\\u0E32\\u0E19\"), /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body table-responsive \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(MDBDataTableV5, {\n    hover: true,\n    entriesOptions: [5, 20, 25],\n    entries: 5,\n    pagesAmount: 4,\n    data: datatable,\n    searchTop: true,\n    searchBottom: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 19\n    }\n  }), loading ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"spinner-border mx-auto mr-4\",\n    style: {\n      width: \"3rem\",\n      height: \"3rem\"\n    },\n    role: \"status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 31\n    }\n  }) : null))))))), /*#__PURE__*/React.createElement(\"aside\", {\n    className: \"control-sidebar control-sidebar-dark\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal fade\",\n    id: \"staticBackdrop2\",\n    \"data-backdrop\": \"static\",\n    \"data-keyboard\": \"false\",\n    tabIndex: \"-1\",\n    \"aria-labelledby\": \"staticBackdropLabel\",\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 1\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-dialog modal-xl\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"modal-title\",\n    id: \"staticBackdropLabel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 9\n    }\n  }, \"Modal title\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"close\",\n    \"data-dismiss\": \"modal\",\n    \"aria-label\": \"Close\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    \"aria-hidden\": \"true\",\n    onClick: () => clearHandle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 11\n    }\n  }, \"\\xD7\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    onClick: () => {\n      console.log(quotaUser);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 23\n    }\n  }, \"\\u0E2D\\u0E35\\u0E40\\u0E21\\u0E25\\u0E4C\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    value: editUser.email,\n    onChange: e => setEditUser({ ...editUser,\n      email: e.target.value\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 23\n    }\n  }, \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E25\\u0E48\\u0E19\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: editUser.name,\n    onChange: e => setEditUser({ ...editUser,\n      name: e.target.value\n    }),\n    className: \"form-control\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 23\n    }\n  }, \"\\u0E40\\u0E1A\\u0E2D\\u0E23\\u0E4C\\u0E42\\u0E17\\u0E23\\u0E28\\u0E31\\u0E1E\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: editUser.phone,\n    className: \"form-control\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 23\n    }\n  }, \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E08\\u0E23\\u0E34\\u0E07\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: editUser.fname,\n    className: \"form-control\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 23\n    }\n  }, \"\\u0E19\\u0E32\\u0E21\\u0E2A\\u0E01\\u0E38\\u0E25\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: editUser.lname,\n    className: \"form-control\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 19\n    }\n  }, quotaUser.map((data, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 31\n    }\n  }, typeLeave.map((dataTypeLeave, keyDataTypeLeave) => /*#__PURE__*/React.createElement(\"div\", {\n    key: keyDataTypeLeave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 35\n    }\n  }, dataTypeLeave.type_leave_id === data.type_leave_id ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 39\n    }\n  }, dataTypeLeave.type_leave_name) : null))), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control\",\n    type: \"number\",\n    defaultValue: data.amount,\n    min: \"0\",\n    id: \"example-number-input\",\n    name: data.quota_id,\n    onChange: e => {\n      countAmount(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 31\n    }\n  }))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"modal-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary\",\n    \"data-dismiss\": \"modal\",\n    onClick: () => clearHandle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 9\n    }\n  }, \"\\u0E1B\\u0E34\\u0E14\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary\",\n    onClick: () => submitHandle(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 9\n    }\n  }, \"\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"))))));\n}\n\nexport default Employee;","map":{"version":3,"sources":["/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/admin/Employee.js"],"names":["React","useEffect","useState","Footer","Navbar","Sidebar","Checkadmin","Form","Userlist","firestore","axios","MDBDataTableV5","data","Employee","user","setUser","loading","setLoading","editQuota","setEditQuota","editUser","setEditUser","quota","setQuota","quotaUser","setQuotaUser","typeLeave","setTypeLeave","refUser","collection","refTypeLeave","refQuota","datatable","setDatatable","columns","label","field","width","attributes","sort","onSnapshot","snapshot","tempArrayQuota","forEach","quota_id","id","type_leave_id","uid","amount","tempArrayTypeLeave","dataa","type_leave_name","tempDataArray","doc","name","fname","lname","email","phone","user_group","edit","editHandle","delete","deleteHandle","rows","tempArrayFilterQuotaUser","filter","obj","leaveId","where","d","console","log","post","then","clearHandle","tempArrayquota","submitHandle","countAmount","e","quotaOfUser","findIndexQuotaUser","findIndex","target","value","height","map","index","dataTypeLeave","keyDataTypeLeave"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Footer from '../../component/admin/Footer';\nimport Navbar from '../../component/admin/Navbar';\nimport Sidebar from '../../component/admin/Sidebar';\nimport Checkadmin from './Checkadmin';\nimport Form from './Employee/Form';\nimport Userlist from './Employee/Employee'\nimport { firestore } from '../../firebase/config'\nimport axios from 'axios'\nimport { MDBDataTableV5 } from 'mdbreact';\nimport { data } from 'jquery';\n\nfunction Employee() {\n  const [user, setUser] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [editQuota,setEditQuota]=useState([])\n  const [editUser,setEditUser]=useState([])\n  const [quota,setQuota]=useState([])  //store all quota\n  const [quotaUser,setQuotaUser]=useState([])\n  const [typeLeave,setTypeLeave]=useState([])  // store all type_leave \n  const refUser = firestore.collection(\"user\");\n  const refTypeLeave  = firestore.collection(\"type_leave\")\n  const refQuota = firestore.collection(\"quota\")\n  const [datatable, setDatatable] = useState({\n    columns: [\n      {\n        label: 'ชื่อพนักงาน',\n        field: 'name',\n        width: 200,\n        attributes: {\n          'aria-controls': 'DataTable',\n          'aria-label': 'Name',\n        },\n      },\n      {\n        label: 'อีเมล',\n        field: 'email',\n        width: 200,\n      },\n      {\n        label: 'เบอร์โทร',\n        field: 'phone',\n        width: 200,\n      },\n      {\n        label: 'แก้ไข',\n        field: 'edit',\n        sort: 'asc',\n        width: 5,\n      },\n      {\n        label: 'ลบ',\n        field: 'delete',\n        sort: 'asc',\n        width: 5,\n      }\n    ],\n    \n  });\n    \n  useEffect(() => {\n\n    //pull data Quota\n    refQuota.onSnapshot(snapshot=>{\n      let tempArrayQuota=[]\n      snapshot.forEach(data=>{\n        tempArrayQuota=[\n          ...tempArrayQuota,\n          {\n            quota_id:data.id,\n            type_leave_id:data.data().type_leave_id,\n            uid:data.data().uid,\n            amount:data.data().amount\n          }\n        ]\n      })\n      setQuota(tempArrayQuota)\n    })\n\n    // pull data type_leave\n    refTypeLeave.onSnapshot(snapshot=>{\n      let tempArrayTypeLeave=[]\n      snapshot.forEach(dataa=>{\n        tempArrayTypeLeave=[\n          ...tempArrayTypeLeave,\n          {\n            type_leave_id:dataa.id,\n            type_leave_name:dataa.data().type_leave_name\n          }\n        ]\n      })\n      setTypeLeave(tempArrayTypeLeave)\n    })\n\n\n\n    //pull data user\n    refUser.onSnapshot(snapshot => {\n      let tempDataArray = [];\n      snapshot.forEach(doc => {\n        tempDataArray = [\n          ...tempDataArray,\n          {\n            name: doc.data().fname + doc.data().lname+\" \" +\"(\"+ doc.data().name+\")\",\n            email: doc.data().email,\n            phone:doc.data().phone,\n            uid: doc.id,\n            user_group: doc.data().user_group,\n            edit:<button  className=\"btn btn-sm btn-outline-success \" data-toggle=\"modal\" data-target=\"#staticBackdrop2\" onClick={()=>{editHandle(doc.data())}}>แก้ไข</button>,\n            delete:<button  className=\"btn btn-sm btn-outline-danger\" onClick={()=>{deleteHandle(doc.id)}}>ลบ</button> \n          }\n        ];\n      })\n      setUser(()=>tempDataArray)\n      setLoading(false)\n      \n    })\n\n\n    setDatatable({...datatable,rows:user})\n    let tempArrayFilterQuotaUser = quota.filter(data=>{\n      return data.uid==editUser.uid\n    })\n    setQuotaUser(()=>tempArrayFilterQuotaUser)\n\n    \n    return () => {\n    };\n  },[user]);\n\n\n  const deleteHandle = async (uid) => {\n    let obj={\n      uid\n    }\n    var leaveId = '';\n    //delete leave of uerr\n    await firestore.collection('leave').where('uid','==',obj.uid)\n    .onSnapshot(doc=>{\n        doc.forEach(data=>{\n          firestore.collection(\"leave\").doc(data.id)\n          .delete()\n          leaveId=data.id\n          firestore.collection(\"appove\").where('leave_id','==',data.id)\n          .onSnapshot(doc=>{\n            doc.forEach(d=>{\n              firestore.collection(\"appove\").doc(d.id)\n              .delete()\n            })\n          })\n          \n        })\n        console.log(leaveId)\n    })\n    // delete quota of user\n     await firestore.collection(\"quota\").where('uid','==',obj.uid)\n    .onSnapshot(doc=>{\n      doc.forEach(data=>{\n        console.log(data.data())\n        firestore.collection(\"quota\").doc(data.id)\n        .delete()\n      })\n    })\n\n    \n    // delete user\n    await axios.post(\"http://localhost:4000/deleteuser\",obj)\n    .then( (uid)=>{\n      const refUser = firestore.collection(\"user\").doc(uid.data)\n       refUser.delete()\n    })\n  }\n\n\n  const editHandle = (data)=>{\n    \n    clearHandle()\n    firestore.collection(\"quota\").where('uid','==',data.uid)\n    .onSnapshot(doc=>{\n      let tempArrayquota =[]\n      doc.forEach(data=>{\n        tempArrayquota=[\n          ...tempArrayquota,\n          {\n            amount:data.data().amount,\n            type_leave_id:data.data().type_leave_id,\n            uid:data.data().uid\n          }\n        ]\n      })\n      setEditQuota(tempArrayquota)\n      setEditUser(data)\n    })\n\n\n\n    \n    \n  }\n\n\n  const submitHandle =()=>{\n    console.log(editUser)\n    console.log(editQuota)\n  }\n\n\n\n  //clear form edit\n  const clearHandle =()=>{\n    setEditUser([])\n  }\n\n\n  const countAmount =(e)=>{\n    // console.log(e.target.value)\n    // console.log(e.target.name)\n    // console.log(quotaUser)\n\n\n    let quotaOfUser = quotaUser\n    //find index array of quota user\n    let findIndexQuotaUser = quotaUser.findIndex(data=>{\n      return data.quota_id===e.target.name\n    })\n\n    quotaOfUser[quotaOfUser]={\n      amount:e.target.value\n    }\n    \n\n    console.log(quotaOfUser)\n  }\n  return (\n    <div>\n      <Checkadmin />\n      <Navbar />\n      <Sidebar />\n      {/* Content Wrapper. Contains page content */}\n      <div className=\"content-wrapper\">\n        {/* Content Header (Page header) */}\n        <div className=\"content-header\">\n          <div className=\"container-fluid\">\n            <div className=\"row mb-2\">\n            </div>{/* /.row */}\n          </div>{/* /.container-fluid */}\n        </div>\n        {/* /.content-header */}\n        {/* Main content */}\n        <div className=\"content\">\n          <div className=\"container-fluid\">\n            <div className=\"row\">\n              <div className=\"col-lg-12\">\n                <div className=\"card\">\n                  <div className=\"card-header \">\n                    <div className=\"d-flex justify-content-between\">\n                      <h3 className=\"m-0 text-dark\" onClick={()=>{console.log(quotaUser)}} >พนักงาน</h3>\n                      <Form />\n                    </div>\n                  </div>\n                  <div className=\"card-body table-responsive \">\n                  <MDBDataTableV5 hover entriesOptions={[5, 20, 25]}  entries={5} pagesAmount={4} data={datatable} searchTop searchBottom={false}/>\n                   \n                        {\n                          loading ? (\n                              <div className=\"spinner-border mx-auto mr-4\" style={{width:\"3rem\",height:\"3rem\"}} role=\"status\">\n                              </div>\n                              \n                          ) : null\n                        }\n                  </div>\n                </div>\n              </div>\n              {/* /.col-md-6 */}\n              {/* /.col-md-6 */}\n            </div>\n            {/* /.row */}\n          </div>\n          {/* /.container-fluid */}\n        </div>\n        {/* /.content */}\n      </div>\n      {/* /.content-wrapper */}\n      {/* Control Sidebar */}\n      <aside className=\"control-sidebar control-sidebar-dark\">\n        {/* Control sidebar content goes here */}\n      </aside>\n      {/* /.control-sidebar */}\n      <Footer />\n\n\n\n{/* <!-- Modal of Edit user --> */}\n<div className=\"modal fade\" id=\"staticBackdrop2\" data-backdrop=\"static\" data-keyboard=\"false\" tabIndex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\n  <div className=\"modal-dialog modal-xl\">\n    <div className=\"modal-content\">\n      <div className=\"modal-header\">\n        <h5 className=\"modal-title\" id=\"staticBackdropLabel\">Modal title</h5>\n        <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\" onClick={()=>clearHandle}>&times;</span>\n        </button>\n      </div>\n      <div className=\"modal-body\">\n      <div className=\"container-fluid\">\n                <div className=\"row\">\n                  <div className=\"col-md-4\">\n                    <div className=\"form-group\">\n                      <label onClick={()=>{console.log(quotaUser)}}>อีเมล์</label>\n                      <input type=\"text\" className=\"form-control\" value={editUser.email} onChange={(e)=>setEditUser({...editUser,email:e.target.value})} ></input>\n                    </div>\n                    <div className=\"form-group\">\n                      <label>ชื่อเล่น</label>\n                      <input type=\"text\" value={editUser.name} onChange={(e)=>setEditUser({...editUser,name:e.target.value})} className=\"form-control\" ></input>\n                    </div>\n                    <div className=\"form-group\">\n                      <label>เบอร์โทรศัพ</label>\n                      <input type=\"text\" value={editUser.phone}  className=\"form-control\" ></input>\n                    </div>\n                  </div>\n                  <div className=\"col-md-4\">\n                    <div className=\"form-group\">\n                      <label>ชื่อจริง</label>\n                      <input type=\"text\" value={editUser.fname}  className=\"form-control\"  ></input>\n                    </div>\n                    <div className=\"form-group\">\n                      <label>นามสกุล</label>\n                      <input type=\"text\" value={editUser.lname}  className=\"form-control\"></input>\n                    </div>\n                    \n                  </div>\n                  <div className=\"col-md-3\">\n                        {\n                          quotaUser.map((data,index)=>(\n                            <div key={index} className=\"form-group\">\n                              \n                              <label>\n                              {\n                                typeLeave.map((dataTypeLeave,keyDataTypeLeave)=>(\n                                  <div key={keyDataTypeLeave}>\n                                    {\n                                      dataTypeLeave.type_leave_id===data.type_leave_id?\n                                      <div>{dataTypeLeave.type_leave_name}</div>\n                                      :null\n                                    }\n                                  </div>\n                                ))\n                                \n                              }\n                              </label>\n                              <input className=\"form-control\" type=\"number\" defaultValue={data.amount} min=\"0\" id=\"example-number-input\" name={data.quota_id}  onChange={(e)=>{countAmount(e)}}  />\n                            </div>\n                          ))\n                        }\n                  </div>\n                </div>\n                </div>\n      </div>\n      <div className=\"modal-footer\">\n        <button type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\" onClick={()=>clearHandle}>ปิด</button>\n        <button type=\"button\" className=\"btn btn-primary\" onClick={()=>submitHandle()}>บันทึก</button>\n      </div>\n    </div>\n  </div>\n</div>\n    </div>\n  );\n}\n\nexport default Employee;\n"]},"metadata":{},"sourceType":"module"}