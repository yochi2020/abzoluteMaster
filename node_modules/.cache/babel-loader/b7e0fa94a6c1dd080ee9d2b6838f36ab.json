{"ast":null,"code":"var _jsxFileName = \"/Users/chanaphatsuzuki/Desktop/programming/abzolute-master/src/page/admin/Leavelist/Leavelist.js\";\nimport React, { useState, useEffect } from 'react';\nimport { firestore } from '../../../firebase/config';\nexport default function Leavelist(props) {\n  const [appove, setAppove] = useState([]);\n  const [leave, setLeave] = useState([]);\n  const [user, setUser] = useState([]);\n  const [typeLeave, setTypeLeave] = useState([]);\n  const refLeave = firestore.collection(\"leave\");\n  const refUser = firestore.collection(\"user\");\n  const refTypeLeave = firestore.collection(\"type_leave\");\n  const [reson, setReson] = useState(); //reson_notAllowed\n\n  useEffect(() => {\n    setAppove(props.data);\n\n    if (props.data.status === \"\") {\n      setAppove({ ...props.data,\n        status: \"รออนุมัติ\"\n      });\n\n      if (props.data.hr_appove !== '') {\n        setAppove({ ...props.data,\n          status: \"รอหัวหน้าอนุมัติ\"\n        });\n      }\n\n      if (props.data.leave_appove !== '') {\n        setAppove({ ...props.data,\n          status: \"รอhrอนุมัติ\"\n        });\n      }\n    }\n\n    refLeave.onSnapshot(doc => {\n      //ดึงLeave ทั้งหมด\n      let tempArrayLeave = [];\n      doc.forEach(data => {\n        tempArrayLeave = [...tempArrayLeave, {\n          amount: data.data().amount,\n          leave_date: data.data().leave_date,\n          leave_start: data.data().leave_start,\n          reson: data.data().reson,\n          type_leave_id: data.data().type_leave_id,\n          uid: data.id,\n          //ไอดีของ leave\n          user_id: data.data().uid // ไอดีของ user\n\n        }];\n      });\n      setLeave(tempArrayLeave);\n    });\n    refUser.onSnapshot(doc => {\n      // ดึงยูเซอร์ทั้งหมด\n      let tempArrayUser = [];\n      doc.forEach(data => {\n        tempArrayUser = [...tempArrayUser, {\n          email: data.data().email,\n          fname: data.data().fname,\n          lname: data.data().lname,\n          name: data.data().name,\n          phone: data.data().phone,\n          uid: data.id,\n          user_group: data.data().user_group\n        }];\n      });\n      setUser(tempArrayUser);\n    });\n    refTypeLeave.onSnapshot(doc => {\n      //ดึง TypeLeave ทั้งหมด\n      let tempArrayTypeLeave = [];\n      doc.forEach(data => {\n        tempArrayTypeLeave = [...tempArrayTypeLeave, {\n          type_leave_name: data.data().type_leave_name,\n          id: data.id\n        }];\n      });\n      setTypeLeave(tempArrayTypeLeave);\n    }); ///////////ทำต่อตรงนี้\n\n    return () => {};\n  }, [props.data]);\n  var appoveLeave = leave.filter(data => data.uid === appove.leave_id);\n  var appoveLeave_typeLeavejoin = appoveLeave.map(data => {\n    return data.type_leave_id;\n  });\n  var typeLeaveJoin = typeLeave.find(data => {\n    return data.id === appoveLeave_typeLeavejoin.toString();\n  });\n  var testt = [{ ...typeLeaveJoin\n  }]; //หาค่ายูเซอร์\n\n  const findUser = appoveLeave.map(data => {\n    return data.user_id;\n  });\n  const userValue = user.find(data => data.uid === findUser.toString());\n  const userValueShow = [{ ...userValue\n  }];\n  return props.data.status === 'no' || props.data.status === 'y' ? null : /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"row\",\n    onClick: () => {\n      console.log(appoveLeave);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }\n  }, userValueShow.map((data, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 115\n    }\n  }, data.fname, \" \", data.lname, \" (\", data.name, \")\"))), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }, userValueShow.map((data, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"far fa-envelope nav-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 33\n    }\n  }), data.email, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 89\n    }\n  }), /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-phone-alt\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 33\n    }\n  }), data.phone))), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 17\n    }\n  }, testt.map((data, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 49\n    }\n  }, data.type_leave_name))), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 17\n    }\n  }, appoveLeave.map((data, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 56\n    }\n  }, data.leave_start))), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 17\n    }\n  }, appoveLeave.map((data, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 56\n    }\n  }, data.amount))), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 17\n    }\n  }, appoveLeave.map((data, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 56\n    }\n  }, data.reson))), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"badge badge-pill badge-dark\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 21\n    }\n  }, appove.status)), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-sm btn-outline-success mr-1\",\n    onClick: props.allow,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 21\n    }\n  }, \"\\u0E2D\\u0E19\\u0E38\\u0E21\\u0E31\\u0E15\\u0E34\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    class: \"btn btn-primary\",\n    \"data-toggle\": \"modal\",\n    \"data-target\": \"#staticBackdrop\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 21\n    }\n  }, \"Launch static backdrop modal\")), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"modal fade\",\n    id: \"staticBackdrop\",\n    \"data-backdrop\": \"static\",\n    \"data-keyboard\": \"false\",\n    tabindex: \"-1\",\n    \"aria-labelledby\": \"staticBackdropLabel\",\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"modal-dialog\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"modal-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"modal-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    class: \"modal-title\",\n    id: \"staticBackdropLabel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 33\n    }\n  }, \"\\u0E2B\\u0E21\\u0E32\\u0E22\\u0E40\\u0E2B\\u0E15\\u0E38\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    class: \"close\",\n    \"data-dismiss\": \"modal\",\n    \"aria-label\": \"Close\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    \"aria-hidden\": \"true\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 37\n    }\n  }, \"\\xD7\"))), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"modal-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control\",\n    value: reson,\n    onChange: e => {\n      setReson(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"modal-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    class: \"btn btn-secondary\",\n    \"data-dismiss\": \"modal\",\n    onClick: () => setReson(\"\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 33\n    }\n  }, \"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\"), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    class: \"btn btn-primary\",\n    onClick: () => $('#myModal').modal('hide'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 33\n    }\n  }, \"\\u0E15\\u0E01\\u0E25\\u0E07\"))))));\n}","map":{"version":3,"sources":["/Users/chanaphatsuzuki/Desktop/programming/abzolute-master/src/page/admin/Leavelist/Leavelist.js"],"names":["React","useState","useEffect","firestore","Leavelist","props","appove","setAppove","leave","setLeave","user","setUser","typeLeave","setTypeLeave","refLeave","collection","refUser","refTypeLeave","reson","setReson","data","status","hr_appove","leave_appove","onSnapshot","doc","tempArrayLeave","forEach","amount","leave_date","leave_start","type_leave_id","uid","id","user_id","tempArrayUser","email","fname","lname","name","phone","user_group","tempArrayTypeLeave","type_leave_name","appoveLeave","filter","leave_id","appoveLeave_typeLeavejoin","map","typeLeaveJoin","find","toString","testt","findUser","userValue","userValueShow","console","log","index","allow","e","target","value","$","modal"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { firestore } from '../../../firebase/config'\nexport default function Leavelist(props) {\n    const [appove, setAppove] = useState([])\n    const [leave, setLeave] = useState([])\n    const [user, setUser] = useState([])\n    const [typeLeave, setTypeLeave] = useState([])\n    const refLeave = firestore.collection(\"leave\")\n    const refUser = firestore.collection(\"user\")\n    const refTypeLeave = firestore.collection(\"type_leave\")\n  const [reson,setReson]=useState() //reson_notAllowed\n\n    useEffect(() => {\n        setAppove(props.data)\n        if (props.data.status === \"\") {\n            setAppove({ ...props.data, status: \"รออนุมัติ\" })\n            if (props.data.hr_appove !== '') {\n                setAppove({ ...props.data, status: \"รอหัวหน้าอนุมัติ\" })\n            }\n            if (props.data.leave_appove !== '') {\n                setAppove({ ...props.data, status: \"รอhrอนุมัติ\" })\n            }\n        }\n        refLeave.onSnapshot(doc => { //ดึงLeave ทั้งหมด\n            let tempArrayLeave = []\n            doc.forEach(data => {\n                tempArrayLeave = [\n                    ...tempArrayLeave,\n                    {\n                        amount: data.data().amount,\n                        leave_date: data.data().leave_date,\n                        leave_start: data.data().leave_start,\n                        reson: data.data().reson,\n                        type_leave_id: data.data().type_leave_id,\n                        uid: data.id,   //ไอดีของ leave\n                        user_id: data.data().uid // ไอดีของ user\n                    }\n                ]\n            })\n            setLeave(tempArrayLeave)\n        })\n\n        refUser.onSnapshot(doc => { // ดึงยูเซอร์ทั้งหมด\n            let tempArrayUser = []\n            doc.forEach(data => {\n                tempArrayUser = [\n                    ...tempArrayUser,\n                    {\n                        email: data.data().email,\n                        fname: data.data().fname,\n                        lname: data.data().lname,\n                        name: data.data().name,\n                        phone: data.data().phone,\n                        uid: data.id,\n                        user_group: data.data().user_group\n                    }\n                ]\n            })\n            setUser(tempArrayUser)\n        })\n\n        refTypeLeave.onSnapshot(doc => { //ดึง TypeLeave ทั้งหมด\n            let tempArrayTypeLeave = []\n            doc.forEach(data => {\n                tempArrayTypeLeave = [\n                    ...tempArrayTypeLeave,\n                    {\n                        type_leave_name: data.data().type_leave_name,\n                        id: data.id\n                    }\n                ]\n            })\n            setTypeLeave(tempArrayTypeLeave)\n        })\n        ///////////ทำต่อตรงนี้\n\n        return () => {\n\n        }\n    }, [props.data])\n\n    var appoveLeave = leave.filter(data => (data.uid === appove.leave_id))\n    var appoveLeave_typeLeavejoin = appoveLeave.map(data => {\n        return data.type_leave_id\n    })\n    var typeLeaveJoin = typeLeave.find(data => {\n        return data.id === appoveLeave_typeLeavejoin.toString()\n    })\n    var testt = [{ ...typeLeaveJoin }]\n\n\n    //หาค่ายูเซอร์\n    const findUser = appoveLeave.map((data => {\n        return data.user_id\n    }))\n    const userValue = user.find(data => (data.uid === findUser.toString()))\n\n    const userValueShow = [{ ...userValue }]\n    return (\n        props.data.status === 'no' || props.data.status === 'y' ? (\n            null\n        ) : <tr>\n                <th scope=\"row\" onClick={() => { console.log(appoveLeave) }}>{userValueShow.map((data, index) => (<div key={index}>{data.fname} {data.lname} ({data.name})</div>))}</th>\n                <td>\n                    {\n                        userValueShow.map((data, index) => (\n                            <div key={index}>\n                                <i className=\"far fa-envelope nav-icon\"></i>{data.email}<br></br>\n                                <i className=\"fas fa-phone-alt\"></i>{data.phone}\n                            </div>\n                        ))\n                    }\n                </td>\n                <td>{testt.map((data, index) => <div key={index}>{data.type_leave_name}</div>)}</td>\n                <td>{appoveLeave.map((data, index) => (<div key={index}>{data.leave_start}</div>))}</td>\n                <td>{appoveLeave.map((data, index) => (<div key={index}>{data.amount}</div>))}</td>\n                <td>{appoveLeave.map((data, index) => (<div key={index}>{data.reson}</div>))}</td>\n                <td>\n                    <span className=\"badge badge-pill badge-dark\">{appove.status}</span>\n                </td>\n                <td>\n                    <button className=\"btn btn-sm btn-outline-success mr-1\" onClick={props.allow}>อนุมัติ</button>\n                    {/* <button className=\"btn btn-sm btn-outline-danger\" onClick={props.notAllowed} >ไม่อนุมัติ</button> */}\n                    <button type=\"button\" class=\"btn btn-primary\" data-toggle=\"modal\" data-target=\"#staticBackdrop\">\n                        Launch static backdrop modal\n                    </button>\n                </td>\n\n                <div class=\"modal fade\" id=\"staticBackdrop\" data-backdrop=\"static\" data-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\n                    <div class=\"modal-dialog\">\n                        <div class=\"modal-content\">\n                            <div class=\"modal-header\">\n                                <h5 class=\"modal-title\" id=\"staticBackdropLabel\">หมายเหตุ</h5>\n                                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                    <span aria-hidden=\"true\">&times;</span>\n                                </button>\n                            </div>\n                            <div class=\"modal-body\">\n                                <input className=\"form-control\" value={reson} onChange={(e)=>{setReson(e.target.value)}}/>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\" onClick={()=>setReson(\"\")}>ยกเลิก</button>\n                                <button type=\"button\" class=\"btn btn-primary\" onClick={()=>$('#myModal').modal('hide')}>ตกลง</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </tr>\n\n    )\n}\n"]},"metadata":{},"sourceType":"module"}