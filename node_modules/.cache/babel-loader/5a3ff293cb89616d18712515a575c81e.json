{"ast":null,"code":"var _jsxFileName = \"/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/user/Userhome.js\";\nimport React, { useEffect, useState } from 'react';\nimport Footer from '../../component/admin/Footer';\nimport Navbar from '../../component/admin/Navbar';\nimport Sidebar from '../../component/user/Sidebar';\nimport Checkuser from './Checkuser';\nimport { firestore, auth } from '../../firebase/config';\nimport Userhome from './UserHome/Userhome';\nimport { MDBDataTableV5 } from 'mdbreact';\nimport { data } from 'jquery';\n\nconst Userleave = () => {\n  const [userId, setUserId] = useState([]);\n  const [appove, setAppove] = useState([]);\n  const [leave, setLeave] = useState([]);\n  const [typeLeave, setTypeLeave] = useState([]);\n  const refAppove = firestore.collection(\"appove\");\n  const refLeave = firestore.collection(\"leave\");\n  const refUser = firestore.collection(\"user\");\n  const refTypeLeave = firestore.collection(\"type_leave\");\n  const [leaveUser, setleaveUser] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [datatable, setDatatable] = React.useState({\n    columns: [{\n      label: 'วันที่แจ้ง',\n      field: 'leave_date',\n      width: 150,\n      attributes: {\n        'aria-controls': 'DataTable',\n        'aria-label': 'Name'\n      }\n    }, {\n      label: 'วันที่ลา',\n      field: 'leave_start',\n      width: 270\n    }, {\n      label: 'จำนวนวัน',\n      field: 'amount',\n      width: 200\n    }, {\n      label: 'ประเภทการลา',\n      field: 'type_leave_name',\n      sort: 'asc',\n      width: 100\n    }, {\n      label: 'เหตุผล',\n      field: 'reson',\n      sort: 'disabled',\n      width: 150\n    }, {\n      label: 'สถานะ',\n      field: 'status',\n      sort: 'disabled',\n      width: 100\n    }]\n  });\n  useEffect(() => {\n    //เก็บค่ายูเซอร์\n    const authUnsubscibe = auth.onAuthStateChanged(firebaseUser => {\n      if (!!firebaseUser) {\n        refUser.doc(firebaseUser.uid).onSnapshot(doc => {\n          setUserId(doc.id);\n        });\n      }\n    }); // เก็บค่า type_leave\n\n    const typeleavesubscibe = refTypeLeave.onSnapshot(doc => {\n      let tempArrayTypeLeave = [];\n      doc.forEach(data => {\n        tempArrayTypeLeave = [...tempArrayTypeLeave, {\n          type_leave_id: data.id,\n          type_leave_name: data.data().type_leave_name\n        }];\n      });\n      setTypeLeave(tempArrayTypeLeave);\n    }); //เก็บค่า Appove\n\n    const appovesubscibe = refAppove.onSnapshot(doc => {\n      let tempArrayAppove = [];\n      doc.forEach(data => {\n        tempArrayAppove = [...tempArrayAppove, {\n          appoveId: data.id,\n          leaveId: data.data().leave_id,\n          hr_appove: data.data().hr_appove,\n          hr_remark: data.data().hr_remark,\n          leave_appove: data.data().leave_appove,\n          leave_remark: data.data().leave_remark,\n          status: data.data().status\n        }];\n      });\n      setAppove(tempArrayAppove);\n    }); // เก็บค่า Leave\n\n    const leavesubscibe = refLeave.onSnapshot(doc => {\n      let tempArrayLeave = [];\n      doc.forEach(data => {\n        tempArrayLeave = [...tempArrayLeave, {\n          leaveId: data.id,\n          type_leave_id: data.data().type_leave_id,\n          uid: data.data().uid,\n          amount: data.data().amount,\n          leave_date: data.data().leave_date,\n          leave_start: data.data().leave_start,\n          reson: data.data().reson\n        }];\n      });\n      setLeave(tempArrayLeave);\n    });\n    setLoading(false);\n    setleaveUser(findLeave);\n    setDatatable({ ...datatable,\n      rows: leaveUser\n    });\n    return () => {};\n  }, []);\n  const [test, setTest] = useState([]); // หา Leave ของ user\n\n  const findLeave = leave.filter(data => data.uid === userId);\n  const temparrayfindleave = findLeave;\n  findLeave.forEach((dataLeave, i) => {\n    appove.forEach(dataAppove => {\n      if (dataLeave.leaveId === dataAppove.leaveId) {\n        temparrayfindleave[i] = { ...temparrayfindleave[i],\n          ...dataAppove\n        };\n      }\n    });\n  });\n  findLeave.forEach((dataLeave, i) => {\n    typeLeave.forEach(dataTypeLeave => {\n      if (dataLeave.type_leave_id === dataTypeLeave.type_leave_id) {\n        temparrayfindleave[i] = { ...temparrayfindleave[i],\n          type_leave_name: dataTypeLeave.type_leave_name\n        };\n      }\n    });\n    findLeave.forEach((dataLeave, i) => {\n      if (dataLeave.status === \"y\") {\n        temparrayfindleave[i] = { ...temparrayfindleave[i],\n          status: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"badge badge-pill badge-dark\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 20\n            }\n          }, \"\\u0E2D\\u0E19\\u0E38\\u0E21\\u0E31\\u0E15\\u0E34\")\n        };\n      }\n\n      if (dataLeave.status === \"\") {\n        temparrayfindleave[i] = { ...temparrayfindleave[i],\n          status: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"badge badge-pill badge-dark\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 20\n            }\n          }, \"\\u0E23\\u0E2D\\u0E2D\\u0E19\\u0E38\\u0E21\\u0E31\\u0E15\\u0E34\")\n        };\n      }\n\n      if (dataLeave.status === \"n\") {\n        temparrayfindleave[i] = { ...temparrayfindleave[i],\n          status: /*#__PURE__*/React.createElement(\"span\", {\n            className: \"badge badge-pill badge-dark\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 20\n            }\n          }, \"\\u0E44\\u0E21\\u0E48\\u0E2D\\u0E19\\u0E38\\u0E21\\u0E31\\u0E15\\u0E34\")\n        };\n      }\n    });\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Checkuser, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Navbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Sidebar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-header \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"m-0 text-dark\",\n    onClick: () => {\n      console.log(findLeave);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 23\n    }\n  }, \"\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23\\u0E25\\u0E32\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body table-responsive \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(MDBDataTableV5, {\n    data: datatable,\n    entriesOptions: [5, 20, 25],\n    entries: 5,\n    pagesAmount: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"table\", {\n    className: \"table table-hover \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    className: \"thead-dark \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    onClick: () => {\n      console.log(temparrayfindleave);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 27\n    }\n  }, \"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\\u0E41\\u0E08\\u0E49\\u0E07\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 27\n    }\n  }, \"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\\u0E25\\u0E32\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 27\n    }\n  }, \"\\u0E08\\u0E33\\u0E19\\u0E27\\u0E19\\u0E27\\u0E31\\u0E19\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 27\n    }\n  }, \"\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\\u0E01\\u0E32\\u0E23\\u0E25\\u0E32\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 27\n    }\n  }, \"\\u0E40\\u0E2B\\u0E15\\u0E38\\u0E1C\\u0E25\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 27\n    }\n  }, \"\\u0E2A\\u0E16\\u0E32\\u0E19\\u0E30\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 23\n    }\n  }, leaveUser.map((data, index) => {\n    return /*#__PURE__*/React.createElement(Userhome, {\n      data: data,\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 38\n      }\n    });\n  })), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 23\n    }\n  }, loading ? /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 31\n    }\n  }), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 31\n    }\n  }), /*#__PURE__*/React.createElement(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 31\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"spinner-border mx-auto\",\n    style: {\n      width: \"3rem\",\n      height: \"3rem\"\n    },\n    role: \"status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 35\n    }\n  }))) : null))))))))), /*#__PURE__*/React.createElement(\"aside\", {\n    className: \"control-sidebar control-sidebar-dark\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default Userleave;","map":{"version":3,"sources":["/Users/chanaphatsuzuki/Desktop/programming/abzolute/src/page/user/Userhome.js"],"names":["React","useEffect","useState","Footer","Navbar","Sidebar","Checkuser","firestore","auth","Userhome","MDBDataTableV5","data","Userleave","userId","setUserId","appove","setAppove","leave","setLeave","typeLeave","setTypeLeave","refAppove","collection","refLeave","refUser","refTypeLeave","leaveUser","setleaveUser","loading","setLoading","datatable","setDatatable","columns","label","field","width","attributes","sort","authUnsubscibe","onAuthStateChanged","firebaseUser","doc","uid","onSnapshot","id","typeleavesubscibe","tempArrayTypeLeave","forEach","type_leave_id","type_leave_name","appovesubscibe","tempArrayAppove","appoveId","leaveId","leave_id","hr_appove","hr_remark","leave_appove","leave_remark","status","leavesubscibe","tempArrayLeave","amount","leave_date","leave_start","reson","findLeave","rows","test","setTest","filter","temparrayfindleave","dataLeave","i","dataAppove","dataTypeLeave","console","log","map","index","height"],"mappings":"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","sourcesContent":["import React,{useEffect,useState} from 'react';\nimport Footer from '../../component/admin/Footer';\nimport Navbar from '../../component/admin/Navbar';\nimport Sidebar from '../../component/user/Sidebar'\nimport Checkuser from './Checkuser';\nimport {firestore,auth} from '../../firebase/config'\nimport   Userhome from './UserHome/Userhome'\nimport {MDBDataTableV5} from 'mdbreact'\nimport { data } from 'jquery';\nconst Userleave = () => {\n    const [userId,setUserId]=useState([])\n    const [appove,setAppove]=useState([])\n    const [leave,setLeave]=useState([])\n    const [typeLeave,setTypeLeave]=useState([])\n    const refAppove = firestore.collection(\"appove\")\n    const refLeave = firestore.collection(\"leave\")\n    const refUser = firestore.collection(\"user\")\n    const refTypeLeave = firestore.collection(\"type_leave\")\n    const [leaveUser,setleaveUser]=useState([])\n    const [loading, setLoading] = useState(true)\n\n    \n    \n    const [datatable, setDatatable] = React.useState({\n      columns: [\n        {\n          label: 'วันที่แจ้ง',\n          field: 'leave_date',\n          width: 150,\n          attributes: {\n            'aria-controls': 'DataTable',\n            'aria-label': 'Name',\n          },\n        },\n        {\n          label: 'วันที่ลา',\n          field: 'leave_start',\n          width: 270,\n        },\n        {\n          label: 'จำนวนวัน',\n          field: 'amount',\n          width: 200,\n        },\n        {\n          label: 'ประเภทการลา',\n          field: 'type_leave_name',\n          sort: 'asc',\n          width: 100,\n        },\n        {\n          label: 'เหตุผล',\n          field: 'reson',\n          sort: 'disabled',\n          width: 150,\n        },\n        {\n          label: 'สถานะ',\n          field: 'status',\n          sort: 'disabled',\n          width: 100,\n        }\n      ],})\n    useEffect(()=>{\n\n      \n      //เก็บค่ายูเซอร์\n      const authUnsubscibe = auth.onAuthStateChanged((firebaseUser)=>{\n        if(!!firebaseUser){\n          refUser.doc(firebaseUser.uid).onSnapshot(doc=>{\n            setUserId(doc.id)\n          })\n        }\n      })\n      \n      // เก็บค่า type_leave\n      const typeleavesubscibe =refTypeLeave.onSnapshot(doc=>{\n        let tempArrayTypeLeave = []\n        doc.forEach(data=>{\n          tempArrayTypeLeave=[\n            ...tempArrayTypeLeave,\n            {\n              type_leave_id:data.id,\n              type_leave_name:data.data().type_leave_name\n            }\n          ]\n        })\n        setTypeLeave(tempArrayTypeLeave)\n      })\n      \n      //เก็บค่า Appove\n      const appovesubscibe = refAppove.onSnapshot(doc=>{\n        let tempArrayAppove =[]\n        doc.forEach(data=>{\n          tempArrayAppove=[\n            ...tempArrayAppove,\n            {\n              appoveId:data.id,\n              leaveId:data.data().leave_id,\n              hr_appove:data.data().hr_appove,\n              hr_remark:data.data().hr_remark,\n              leave_appove:data.data().leave_appove,\n              leave_remark:data.data().leave_remark,\n              status:data.data().status\n            }\n          ]\n        })\n        setAppove(tempArrayAppove)\n      })\n\n      // เก็บค่า Leave\n      const leavesubscibe =refLeave.onSnapshot(doc=>{\n        let tempArrayLeave=[]\n        doc.forEach(data=>{\n          tempArrayLeave=[\n            ...tempArrayLeave,\n            {\n              leaveId:data.id,\n              type_leave_id:data.data().type_leave_id,\n              uid:data.data().uid,\n              amount:data.data().amount,\n              leave_date:data.data().leave_date,\n              leave_start:data.data().leave_start,\n              reson:data.data().reson\n            }\n          ]\n        })\n        setLeave(tempArrayLeave)\n        \n      })\n      setLoading(false)\n      setleaveUser(findLeave)   \n      setDatatable({...datatable,rows:leaveUser})\n    return ()=>{\n      \n    }\n    \n    },[])\n    const [test,setTest]=useState([])\n     // หา Leave ของ user\n     const findLeave = leave.filter(data=>(data.uid===userId))\n     const temparrayfindleave = findLeave\n\n\n\n     findLeave.forEach((dataLeave,i)=>{\n      appove.forEach(dataAppove=>{\n        if(dataLeave.leaveId===dataAppove.leaveId){\n          temparrayfindleave[i]={\n            ...temparrayfindleave[i],\n            ...dataAppove\n          }\n        }\n      })\n    })\n\n\n    findLeave.forEach((dataLeave,i)=>{\n      typeLeave.forEach(dataTypeLeave=>{\n        if(dataLeave.type_leave_id===dataTypeLeave.type_leave_id){\n          temparrayfindleave[i]={\n            ...temparrayfindleave[i],\n            type_leave_name:dataTypeLeave.type_leave_name\n          }\n        }\n      })\n\n\n      findLeave.forEach((dataLeave,i)=>{\n        if(dataLeave.status===\"y\"){\n          temparrayfindleave[i]={\n            ...temparrayfindleave[i],\n            status:<span className=\"badge badge-pill badge-dark\">อนุมัติ</span>\n          }\n        }  \n        if(dataLeave.status===\"\"){\n          temparrayfindleave[i]={\n            ...temparrayfindleave[i],\n            status:<span className=\"badge badge-pill badge-dark\">รออนุมัติ</span>\n          }\n        }  \n        if(dataLeave.status===\"n\"){\n          temparrayfindleave[i]={\n            ...temparrayfindleave[i],\n            status:<span className=\"badge badge-pill badge-dark\">ไม่อนุมัติ</span>\n          }\n        }  \n      })\n\n\n\n    })\n    return (\n      <div>\n      <Checkuser />\n      <Navbar />\n      <Sidebar />\n      {/* Content Wrapper. Contains page content */}\n      <div className=\"content-wrapper\">\n        {/* Content Header (Page header) */}\n        <div className=\"content-header\">\n          <div className=\"container-fluid\">\n            <div className=\"row mb-2\">\n            </div>{/* /.row */}\n          </div>{/* /.container-fluid */}\n        </div>\n        {/* /.content-header */}\n        {/* Main content */}\n        <div className=\"content\">\n          <div className=\"container-fluid\">\n            <div className=\"row\">\n              <div className=\"col-lg-12\">\n                <div className=\"card\">\n                  <div className=\"card-header \">\n                    <div className=\"d-flex justify-content-between\">\n                      <h3 className=\"m-0 text-dark\" onClick={()=>{console.log(findLeave)}} >รายการลาทั้งหมด</h3>\n                    </div>\n                  </div>\n                  <div className=\"card-body table-responsive \">\n                    <MDBDataTableV5 data={datatable} entriesOptions={[5, 20, 25]} entries={5} pagesAmount={4}/>\n                    <table className=\"table table-hover \">\n                      <thead className=\"thead-dark \">\n                        <tr>\n                          <th scope=\"col\" onClick={()=>{console.log(temparrayfindleave)}}>วันที่แจ้ง</th>\n                          <th scope=\"col\">วันที่ลา</th>\n                          <th scope=\"col\">จำนวนวัน</th>\n                          <th scope=\"col\">ประเภทการลา</th>\n                          <th scope=\"col\">เหตุผล</th>\n                          <th scope=\"col\">สถานะ</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                          {\n                            leaveUser.map((data,index)=>{\n                              return <Userhome data={data} key={index}/>\n                            })\n                          }\n                      </tbody>\n                      <tbody>\n                      {\n                        loading ?(\n                            <tr>\n                              <td></td>\n                              <td></td>\n                              <td><div className=\"spinner-border mx-auto\" style={{width:\"3rem\",height:\"3rem\"}} role=\"status\">\n                            </div></td>\n                            </tr>\n                        )\n                        : null\n                      }\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              </div>\n              {/* /.col-md-6 */}\n              {/* /.col-md-6 */}\n            </div>\n            {/* /.row */}\n          </div>\n          {/* /.container-fluid */}\n        </div>\n        {/* /.content */}\n      </div>\n      {/* /.content-wrapper */}\n      {/* Control Sidebar */}\n      <aside className=\"control-sidebar control-sidebar-dark\">\n        {/* Control sidebar content goes here */}\n      </aside>\n      {/* /.control-sidebar */}\n      <Footer />\n    </div >\n    );\n};\n\nexport default Userleave;"]},"metadata":{},"sourceType":"module"}